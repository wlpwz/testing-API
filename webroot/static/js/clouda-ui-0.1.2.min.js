/* clouda-ui v0.1.2 2014-02-19 */

var clouda=clouda||{};!function(a,b,c,d){var e,f,g;!function(a){function b(a,b){return v.call(a,b)}function c(a,b){var c,d,e,f,g,h,i,j,k,l,m=b&&b.split("/"),n=t.map,o=n&&n["*"]||{};if(a&&"."===a.charAt(0))if(b){for(m=m.slice(0,m.length-1),a=m.concat(a.split("/")),j=0;j<a.length;j+=1)if(l=a[j],"."===l)a.splice(j,1),j-=1;else if(".."===l){if(1===j&&(".."===a[2]||".."===a[0]))break;j>0&&(a.splice(j-1,2),j-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((m||o)&&n){for(c=a.split("/"),j=c.length;j>0;j-=1){if(d=c.slice(0,j).join("/"),m)for(k=m.length;k>0;k-=1)if(e=n[m.slice(0,k).join("/")],e&&(e=e[d])){f=e,g=j;break}if(f)break;!h&&o&&o[d]&&(h=o[d],i=j)}!f&&h&&(f=h,g=i),f&&(c.splice(0,g,f),a=c.join("/"))}return a}function h(b,c){return function(){return o.apply(a,w.call(arguments,0).concat([b,c]))}}function i(a){return function(b){return c(b,a)}}function j(a){return function(b){r[a]=b}}function k(c){if(b(s,c)){var d=s[c];delete s[c],u[c]=!0,n.apply(a,d)}if(!b(r,c)&&!b(u,c))throw new Error("No "+c);return r[c]}function l(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function m(a){return function(){return t&&t.config&&t.config[a]||{}}}var n,o,p,q,r={},s={},t={},u={},v=Object.prototype.hasOwnProperty,w=[].slice;p=function(a,b){var d,e=l(a),f=e[0];return a=e[1],f&&(f=c(f,b),d=k(f)),f?a=d&&d.normalize?d.normalize(a,i(b)):c(a,b):(a=c(a,b),e=l(a),f=e[0],a=e[1],f&&(d=k(f))),{f:f?f+"!"+a:a,n:a,pr:f,p:d}},q={require:function(a){return h(a)},exports:function(a){var b=r[a];return"undefined"!=typeof b?b:r[a]={}},module:function(a){return{id:a,uri:"",exports:r[a],config:m(a)}}},n=function(c,e,f,g){var i,l,m,n,o,t,v=[],w=typeof f;if(g=g||c,"undefined"===w||"function"===w){for(e=!e.length&&f.length?["require","exports","module"]:e,o=0;o<e.length;o+=1)if(n=p(e[o],g),l=n.f,"require"===l)v[o]=q.require(c);else if("exports"===l)v[o]=q.exports(c),t=!0;else if("module"===l)i=v[o]=q.module(c);else if(b(r,l)||b(s,l)||b(u,l))v[o]=k(l);else{if(!n.p)throw new Error(c+" missing "+l);n.p.load(n.n,h(g,!0),j(l),{}),v[o]=r[l]}m=f?f.apply(r[c],v):d,c&&(i&&i.exports!==a&&i.exports!==r[c]?r[c]=i.exports:m===a&&t||(r[c]=m))}else c&&(r[c]=f)},e=f=o=function(b,c,d,e,f){return"string"==typeof b?q[b]?q[b](c):k(p(b,c).f):(b.splice||(t=b,c.splice?(b=c,c=d,d=null):b=a),c=c||function(){},"function"==typeof d&&(d=e,e=f),e?n(a,b,c,d):setTimeout(function(){n(a,b,c,d)},4),o)},o.config=function(a){return t=a,t.deps&&o(t.deps,t.callback),o},e._defined=r,g=function(a,c,d){c.splice||(d=c,c=[]),b(r,a)||b(s,a)||(s[a]=[a,c,d])},g.amd={jQuery:!0}}(),g("almond",function(){}),g("consts",[],function(){"use strict";var a="$$cloudaui:",b="cloudaui-";return{version:1,sysKeyPre:a,hashTagKey:a+"hashtag",attrNodeId:b+"nid",attrUUID:b+"uuid",attrUpgradedFlag:b+"upgraded",attrSelector:b+"selector"}}),g("utils",["consts"],function(a){"use strict";function e(a){a.debug||(a.debug=a.info),k.log=a}var f=console,g=function(){},h={log:g,error:g,warn:g,info:g,debug:g,trace:g};Function.prototype.bind&&["error","warn"].forEach(function(a){h[a]=f[a].bind(f)});var i=!("undefined"==typeof module||!module.exports),j=!("undefined"==typeof c||!c.getElementById),k={slientLogger:h,setLogger:e,setDebugMode:function(a){e(a?f:h)},domReady:function(a){return/complete|loaded|interactive/.test(c.readyState)?(a(),void 0):(c.addEventListener("DOMContentLoaded",function(){a()},!1),void 0)},extend:function(a){return a||(a={}),Array.prototype.slice.call(arguments,1).forEach(function(b){if(b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}),a},subset:function(a){var b={};return a&&a.length?(this.isArray(a)||(a=[a]),Array.prototype.slice.call(arguments,1).forEach(function(c){if(c)for(var d=0,e=a.length;e>d;d++)c.hasOwnProperty(a[d])&&(b[a[d]]=c[a[d]])}),b):b},isArray:function(a){return Array.isArray?Array.isArray(a):"[object Array]"==Object.prototype.call(a)},isObject:function(a){return"[object Object]"==Object.prototype.toString.call(a)},isFunction:function(a){return"[object Function]"==Object.prototype.toString.call(a)},isNumber:function(a){return"[object Number]"==Object.prototype.toString.call(a)},isString:function(a){return"[object String]"==Object.prototype.toString.call(a)},isDefined:function(a){return"undefined"!=typeof a},isSimpleValue:function(a){return!(this.isObject(a)||this.isArray(a)||this.isFunction(a))},isSetter:function(a,b){if(!Object.getOwnPropertyDescriptor)return null;var c=Object.getOwnPropertyDescriptor(a,b);return!(!c||!c.set)},isCloudaUITag:function(a){return a.indexOf("-")>0},random:function(a){var b="",c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",d=c.length;a||(a=6);for(var e=0;a>e;e++)b+=c.charAt(this.randomInt(0,d-1));return b},randomInt:function(a,b){return Math.floor(Math.random()*(b-a+1))+a},inherit:function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},getUrlDir:function(a){a=a.split("?")[0],a=this.qualifyUrl(a);var b=a.indexOf("//")+2,c=a.substr(b).lastIndexOf("/");return-1==c?a+"/":a.substr(0,b+c+1)},qualifyUrl:function(a,b){if(!b){var d=c.createElement("a");return d.href=a,d.href}var e,f=c,g=f.head||f.getElementsByTagName("head")[0],h=f.getElementsByTagName("base")[0],i=h&&h.href,j=h||g.appendChild(f.createElement("base")),k=f.createElement("a");return j.href=b,k.href=a,e=k.href,h?h.href=i:g.removeChild(j),e},ajaxGet:function(a){var c=new b.XMLHttpRequest;return a.async!==!1&&(a.async=!0),a.async&&(c.onreadystatechange=function(){if(4==c.readyState){var b;c.status>=200&&c.status<300||0===c.status&&"file:"==location.protocol?(b=c.responseText,a.callback(b)):a.callback(c.responseText)}}),c.open("GET",a.url,a.async),c.send(a.query||""),a.async?void 0:200===c.status?c.responseText:!1},trim:function(a){return a?a.trim?a.trim():a.replace(/^\s+|\s+$/gm,""):""},trigger:function(a,b,d){if(!a)return this.log.error("emply element passed in"),void 0;d=d||{};var e,f={bubbles:!0,cancelable:!0,detail:d};return"undefined"!=typeof CustomEvent?(e=new CustomEvent(b,f),a.dispatchEvent(e)):(e=c.createEvent("CustomEvent"),e.initCustomEvent(b,!0,!0,d),a.dispatchEvent(e)),!0},runInGlobal:function(a,c){var d=[],e=[];if(c)for(var f in c)d.push(f),e.push(c[f]);return new Function(d.join(","),a).apply(b,e)},pathValue:function(a,b,c,d){if(d&&b.indexOf("[")>=0)throw new Error("pathValue setMode not support array for now!!1");var e=b.split("."),f=a,g=/^([^\[]+)((\[\d+\])+)$/,h=/\[(\d+)\]/g,i=0,j=e.length,k=e.some(function(a,b){if(i++,null===f||void 0===f)return!0;if(d&&(this.isDefined(f[a])||(f[a]={}),b==j-1&&(f[a]=c)),!this.isDefined(f[a])){if(a.indexOf("[")>0){var e=g.exec(a);if(e&&e[1]&&this.isDefined(f[e[1]])){f=f[e[1]];for(var k;null!==(k=h.exec(e[2]));){var l=parseInt(k[1],10);if(i++,!Array.isArray(f)||!this.isDefined(f[l]))return!0;f=f[l]}return}}return!0}f=f[a]},this);return d?a:k?"undefined"!=typeof c?c:"":f},isSysOwnedFld:function(b){return 0===b.indexOf(a.sysKeyPre)},isEqual:function(b,c){if(b===c)return!0;if(null===b||null===c)return!1;if(b!==b&&c!==c)return!0;var e,f,g=a.hashTagKey,h=typeof b,i=typeof c,j=null;if(h==i&&"object"==h){if(!this.isArray(b)){if(b[g]&&c[g]&&b[g]===c[g])return!0;f={};for(j in b)if(b.hasOwnProperty(j)&&!this.isSysOwnedFld(j)){if(!this.isEqual(b[j],c[j]))return!1;f[j]=!0}for(j in c)if(c.hasOwnProperty(j)&&!this.isSysOwnedFld(j)&&!f[j]&&c[j]!==d&&"function"!=typeof c[j])return!1;return!0}if(b.length==c.length){for(e=b.length,j=0;e>j;j++)if(!this.isEqual(b[j],c[j]))return!1;return!0}}return!1},copy:function(a){var b;if(this.isArray(a)){b=[];for(var c=0,d=a.length;d>c;c++)b.push(this.copy(a[c],1));return b}if(this.isObject(a)){b={};for(var e in a)a.hasOwnProperty(e)&&!this.isSysOwnedFld(e)&&(b[e]=this.copy(a[e],1));return b}return a},isNodeEnv:function(){return i},isBrowserEnv:function(){return j},nextTick:function(a){("object"==typeof process&&process.nextTick?process.nextTick:function(a){setTimeout(a,0)})(a)},isPlainObject:function(a){if(!a||!this.isObject(a)||a.nodeType)return!1;if(a.constructor&&!a.hasOwnProperty("constructor")&&!a.constructor.prototype.hasOwnProperty("isPrototypeOf"))return!1;var b=void 0;for(b in a);return b===d||a.hasOwnProperty(b)},removeFromArray:function(a,b){var c=a.indexOf(b);return c>-1&&a.splice(c,1),c},size:function(a){if(null===a)return 0;if(a.length===+a.length)return a.length;var b=0;for(var c in a)a.hasOwnProperty(c)&&b++;return b}};return k.setDebugMode(!1),k}),g("event",["utils"],function(a){"use strict";function b(){this.__evHash={}}return a.extend(b.prototype,{on:function(a,b,c){if(this.__multiCall(a,b,this.on))return this;var d=this.__evHash;d[a]||(d[a]=[]);var e=d[a],f=this.__index(e,b);if(0>f){"number"!=typeof c&&(c=10);for(var g=e.length,h=0,i=e.length;i>h;h++)if(c>e[h].priority){g=h;break}e.splice(g,0,{listener:b,priority:c})}return this},once:function(a,b,c){function d(){e.__callListenser(b,arguments),e.off(a,d)}if(this.__multiCall(a,b,this.once))return this;var e=this;return this.on(a,d,c),this},offAll:function(){for(var a in this.__evHash)this.off(a);return this.__evHash={},this},off:function(a,b){if(this.__multiCall(a,b,this.off))return this;var c=this.__evHash;if(c[a]){var d=c[a];if("undefined"==typeof b){var e=d.length;return d.length=0,e}var f=this.__index(d,b);return f>=0?(d.splice(f,1),1):0}},listenerLength:function(a){var b=this.__evHash,c=b[a];return c?c.length:0},emit:function(a){var b,c,d=this.__evHash,e=0;return c=d[a],c&&c.length&&(b=Array.prototype.slice.call(arguments,1),e+=this.__callListenerList(c,b)),c=d["*"],c&&c.length&&(b=Array.prototype.slice.call(arguments),e+=this.__callListenerList(c,b)),e},onDestroy:function(a,b){return this.on("__destroy",a,b),this},destroy:function(){return this.__destroying?void 0:(this.__destroying=1,this.emit("__destroy",this),this.offAll(),this)},__multiCall:function(b,c,d){if(a.isObject(b)&&"undefined"==typeof c){for(var e in b)d.call(this,e,b[e]);return!0}if("string"==typeof b){var f=b.split(/[\s,]+/);if(f.length>1){for(var g=0,h=f.length;h>g;g++)d.call(this,f[g],c);return!0}}return!1},__index:function(a,b){var c=-1;return a.some(function(a,d){return a.listener===b?(c=d,!0):void 0}),c},__callListenser:function(a,b){var c=null,e=null;return"function"==typeof a?(c=a,e=this):2==a.length&&(c=a[1],e=a[0]),c?[1,c.apply(e,b)]:[0,d]},__callListenerList:function(a,b){if(!a||!a.length)return 0;a=[].concat(a);for(var c,d=0,e=0,f=a.length;f>e&&(c=this.__callListenser(a[e].listener,b),d+=c[0],c[1]!==!1);e++);return d}}),b}),g("live-item-manager",["utils","event"],function(a,b){"use strict";function c(a){c.__super__.constructor.apply(this,arguments),this.name=a,this.__unReadyCount=0}return a.inherit(c,b),a.extend(c.prototype,{__increaseUnReadyCount:function(){this.__emitUnReadyCount(this.__unReadyCount+1)},__decreaseUnReadyCount:function(){this.__emitUnReadyCount(this.__unReadyCount-1)},__emitUnReadyCount:function(a){this.emit("unReadyCountChange",a,this.__unReadyCount),this.__unReadyCount=a},onUnReadyCountDownToZero:function(a){this.on("unReadyCountChange",function b(c,d){0===c&&d>0&&(a(c,d),this.off("unReadyCountChange",b))})}}),c}),g("loader",["utils","event"],function(a,b){"use strict";function c(){c.__super__.constructor.apply(this,arguments)}var d={};return a.inherit(c,b),a.extend(c.prototype,{getCache:function(){return d},addCache:function(b,c){return a.isObject(b)?this.addCacheMap.apply(this,arguments):(d[b]={stat:"ok",body:c},!0)},addCacheMap:function(b){var c=b.caches,d=b.base;for(var e in c)this.addCache(a.qualifyUrl(e,d),c[e]);return!0},loadSyncly:function(b){var c=d[b];if(c&&"ok"==c.stat)return c.body;var e=!1;try{e=a.ajaxGet({async:!1,url:b})}catch(f){a.log.error(f.stack)}return e!==!1&&this.addCache(b,e),e},loadSingle:function(b,c){var e=d[b];if(e)switch(e.stat){case"ok":return c&&setTimeout(c,0,e.body),void 0;case"pending":return e.callbackList.push(c),void 0;default:throw new Error("unknown stat: ",e.stat)}else{d[b]={stat:"pending",callbackList:[c]};var f=this;a.ajaxGet({url:b,callback:function(c){c===!1&&a.log.error("Url load failed: "+b),f.emit("loadFromRemote",b,c),a.extend(d[b],{stat:"ok",body:c}),d[b].callbackList&&(d[b].callbackList.forEach(function(a){a&&a(c)}),d[b].callbackList.length=0,delete d[b].callbackList)}})}},loadMultiple:function(b,c){if(!b)throw"no import uri specified";a.isArray(b)||(b=[b]);var d=b.length;if(0===d&&c)return setTimeout(c,0,{}),void 0;var e={};b.forEach(function(a){this.loadSingle(a,function(b){d--,e[a]={body:b},0===d&&c&&c(e)})},this)}}),new c("clouda")}),g("tag-parser",["utils"],function(){"use strict";function a(a,b,c,d){function e(a,b){if(!a)return!1;var c=new RegExp("\\s"+b+"\\s*=\\s*(['\"])(.*?)\\1","mi"),d=a.match(c);return d?d[2]:(c=new RegExp("\\s"+b+"\\b","mi"),d=a.match(c),d?"":!1)}function f(a,b){var c={};return b&&b.length?(b.forEach(function(b){var d=e(a,b);c[b]=d!==!1?d:null}),c):c}var g,h=[],i=new RegExp("<[\\s]*("+b+")([^>]*)>","gmi");d="number"!=typeof d?-1:d;for(var j=0;null!==(g=i.exec(a));){var k=g[1],l=g[2],m=!1;"/"==l[l.length-1]&&(m=!0,l=l.substr(0,l.length-1));var n={};if(n.tag=k.toUpperCase(),m)n.outerContent=g[0],n.content="";else{var o="</"+k+">",p=a.indexOf(o,g.index+g[0].length);p>=0&&(n.outerContent=a.substring(g.index,p+o.length),n.content=a.substring(g.index+g[0].length,p))}if(n.attributes=f(l,c),h.push(n),j++,d>0&&j>=d)break}return h}function b(b,c,d){var e=a.apply(null,[b,c,d,1]);return e.length?e[0]:{content:"",attributes:{}}}return{parseTagInfo:a,parseSingleTagInfo:b}}),g("ui-importer",["utils","loader","event","tag-parser"],function(a,b,c,d){"use strict";function e(){e.__super__.constructor.apply(this,arguments),this.__loader=b}var f={};return a.inherit(e,c),a.extend(e.prototype,{getHistoryUrls:function(){var a=[];for(var b in f)a.push(b);return a},addCache:function(b){var c;for(var d in b.caches)c=b.caches[d],c.url=a.qualifyUrl(c.url,b.base),f[c.url]||(f[c.url]={}),f[c.url][d]=c},"import":function(b,c,d){if(!b)throw"no import uri specified";a.isArray(b)||(b=[b]),a.isFunction(c)&&(d=c,c=!1);var e=this,g={};this.__loader.loadMultiple(b.map(function(b){var d=a.qualifyUrl(b,c);return d}).filter(function(b){return f[b]?(g[b]=f[b],!1):(a.log.debug("import ui: ",b),!0)}),function(a){if(a)for(var b in a)f[b]||a[b].body&&(g[b]=f[b]=e.__parseElDef(a[b].body,b));d&&d(g)})},__parseElDef:function(a,b){function c(a,b,c){l[b]=c}if(!a)return!1;for(var d,e,f,g,h=/(<[\s]*clouda-component([^>]+)>)([\s\S]*)/im,i=/<[\s]*\/[\s]*clouda-component[\s]*>/im,j=/([^'"\s]+)=['"]([^'"]+)['"]/gim,k=a,l={},m={};;){if(d=k.match(h),!d)break;d[1].replace(j,c),f=d[1].length,e=k.indexOf(d[1]),g=k.search(i),-1==g&&(g=k.length);var n=k.substr(e+f,g-(e+f)),o=this.__parseDefContent(l,n,b);o&&o.name&&(m[o.name]=o),k=k.substr(g)}return m},__parseDefContent:function(b,c,d){var e=b.name;return e?a.extend({name:e,attributes:b,url:d},this.__parseResource(c,a.getUrlDir(d))):(a.log.error("No name specified for clouda-component"),!1)},__parseResource:function(b,c){function e(b){return i.__loader.loadSyncly(a.qualifyUrl(b,c))}var f,g,h,i=this,j=[];return f=d.parseSingleTagInfo(b,"template").content,f=f.replace(/<!--[^]*?-->/gm,""),g=[],d.parseTagInfo(f,"style|link",["global","id","src","rel","href"]).forEach(function(b){if(f=f.replace(b.outerContent,""),a.isString(b.attributes.global)){var d={};if(b.attributes.href){var h=a.qualifyUrl(b.attributes.href,c);a.extend(d,{attributes:{href:h}}),b.outerContent=b.outerContent.replace(b.attributes.href,h),b.attributes.href=h}a.extend(d,{id:b.attributes.global||b.attributes.id||b.attributes.href,type:b.tag.toLowerCase(),html:b.outerContent}),d.id||(d.id=d.type+": "+a.random(10)),j.push(d)}else if("LINK"==b.tag){if("stylesheet"==b.attributes.rel){if(!b.attributes.href)return;g.push(e(b.attributes.href))}}else b.attributes.src?g.push(e(b.attributes.src)):g.push(b.content)}),g=g.join("\n"),h=[],d.parseTagInfo(b,"script",["global","id","src"]).forEach(function(b){if(f=f.replace(b.outerContent,""),a.isString(b.attributes.global)){var d={};if(b.attributes.src){var g=a.qualifyUrl(b.attributes.src,c);a.extend(d,{attributes:{src:g}}),b.outerContent=b.outerContent.replace(b.attributes.src,g),b.attributes.src=g}a.extend(d,{id:b.attributes.global||b.attributes.id||b.attributes.src,type:"script",html:b.outerContent}),d.id||(d.id=d.type+": "+a.random(10)),j.push(d)}else if(b.attributes.src){var i=e(b.attributes.src);i&&h.push(i)}else h.push(b.content)},this),h=h.join("\n"),{template:f,style:g,scriptLiteral:h,globalResources:j}}}),new e("clouda")}),g("live-item",["utils","event"],function(a,b){"use strict";function c(a){c.__super__.constructor.apply(this,arguments),this.name=a,this.__readyArgs=!1}var d="__ev_ready";return a.inherit(c,b),a.extend(c.prototype,{onReady:function(a){this.once(d,a),this.isReady()&&this.emitReady.apply(this,this.__readyArgs)},emitReady:function(){var a=Array.prototype.slice.call(arguments);this.__readyArgs=[].concat(a),a.unshift(d),this.emit.apply(this,a)},isReady:function(){return this.__readyArgs!==!1}}),c}),g("ui-define-item",["utils","live-item"],function(a,b){"use strict";function c(b,d){c.__super__.constructor.apply(this,arguments),this.name=b,this.__props=d.props,a.extend(this,this.__props)}return a.inherit(c,b),a.extend(c.prototype,{getProps:function(){return this.__props}}),c}),g("ui-registry",["utils","live-item-manager","ui-importer","ui-define-item"],function(a,b,c,e){"use strict";function f(){f.__super__.constructor.apply(this,arguments),this.__defines={}}return a.inherit(f,b),a.extend(f.prototype,{getDefines:function(){return this.__defines},getDefine:function(a){return a?this.__defines[a]:this.__defines},fetchElementDef:function(b,d,e){a.isFunction(d)&&(e=d,d=!1),a.isArray(b)||(b=[b]),b=b.map(function(b){return a.qualifyUrl(b,d)}),d=!1;var f={};b=b.filter(function(a){var b=!1;for(var c in this.__defines)this.__defines[c].url==a&&(f[c]=this.__defines[c],b=!0);return!b},this);var g=this;c.import(b,d,function(a){var b,c={};for(var d in a){b=a[d];for(var h in b)c[h]=f[h]=b[h]}g.addDefine({defines:c}),e&&e(f),g.emit("fetchElementDone",f)})},__execDefScript:function(b){var c=this.__defines,e=this,f=c[b],g=a.getUrlDir(f.url);if(f.defineUIExecuted)return a.log.warn("UI alreay executed: ",b),void 0;var h=function(c,d){return a.isArray(c)&&(c=c.map(function(b){return a.qualifyUrl(b,g)})),e.defineUI(b,c,d)};if(f.attributes.attributes||(f.attributes.attributes=""),a.extend(h,{cname:b,url:f.url,urlBase:g,attributes:f.attributes.attributes.split(/\s+/),setAttributes:function(b){a.isArray(b)&&(b=b.join(" ")),f.attributes.attributes=b},getAttributes:function(){return f.attributes.attributes},"import":function(a,b){e.fetchElementDef(a,g,b)}}),f.scriptDefine&&a.isFunction(f.scriptDefine))f.scriptDefine.call(d,h);else try{a.runInGlobal(f.scriptLiteral,{cloudaui:h})}catch(i){a.log.error(i.stack)}return f.defineUIExecuted?!0:(a.log.warn(b+' is not properly defined, make sure use "cloudaui(depends, options)" to define it'),delete c[b],!1)},defineUI:function(b,c,d){a.isArray(c)||(d=c,c=[]);var e=this.__defines,f=this,g=e[b];g.scriptOptions=d,c.length?(g.__dependencies=c,g.__unReadyDeps=[].concat(c),this.fetchElementDef(c,function(){f.__cleanDefDeps()})):this.__cleanDefDeps(b),g.defineUIExecuted=!0},__cleanDefDeps:function(a){var b=this.__defines,c=null;if(a){if(!b[a])throw new Error("def "+a+" not found");b[a].emitReady();var d=b[a].url;for(c in b){var e=b[c];if(!e.isReady()&&e.__unReadyDeps){var f=e.__unReadyDeps.indexOf(d);f>-1&&e.__unReadyDeps.splice(f,1),e.__unReadyDeps.length||(delete e.__unReadyDeps,this.__cleanDefDeps(c))}}}else for(c in b)b[c].isReady()&&this.__cleanDefDeps(c)},addDefine:function(b){function c(){g.__decreaseUnReadyCount()}var d,f,g=this,h=this.__defines,i=[];for(var j in b.defines)f=b.defines[j],h[j]?h[j].url!=f.url&&a.log.warn("UI name conflict: ",j,h[j].url,f.url):(f.url=a.qualifyUrl(f.url,b.base),g.__increaseUnReadyCount(),d=new e(j,{props:f}),d.onReady(c,0),h[j]=d,i.push(j));i.forEach(function(a){this.__execDefScript(a)},this)}}),new f("clouda")}),g("ui-script",["utils"],function(a){"use strict";var b=function(b,c,d){a.extend(this,c),this.__extendSelf(d)};return a.extend(b.prototype,{__extendSelf:function(a){for(var b in a)if(a.hasOwnProperty(b)){if(this[b])throw new Error(b+" is a reserved word");this[b]=a[b]}["created","ready","destroy"].forEach(function(a){this[a]||(this[a]=this["__"+a])},this)},utils:a,emit:function(){var b=Array.prototype.slice.call(arguments);return b.unshift(this.$.root),a.trigger.apply(a,b)},sync:function(){throw new Error("sync unimplement!")},__created:function(b){a.log.info("UI created: ",b)},__ready:function(b){a.log.info("UI ready: ",b)},__destroy:function(b){a.log.info("UI destroy: ",b)}}),b}),g("pubsub",["utils","event"],function(a,b){"use strict";function c(b,e){c.__super__.constructor.apply(this,arguments),this.options=a.extend({thisArg:d},e),this.__pubedValues={},this.__subedKeys=[]}return a.inherit(c,b),a.extend(c.prototype,{keys:function(){return this.__subedKeys},keySubed:function(a){return this.__subedKeys.indexOf(a)>=0},getPubedValue:function(a){return this.__pubedValues[a]},subscribe:function(a,b){this.__subedKeys.push(a),this.on(a,b)},unSubscribe:function(b,c){this.off(b,c),a.removeFromArray(this.__subedKeys,b)},publish:function(b,c){if(this.keySubed(b)){var d=this.getPubedValue(b);if(a.isEqual(c,d))return!1;c=this.__tryCopy(c),this.__pubedValues[b]=c,this.emit(b,c,d)}},__tryCopy:function(b){return a.isArray(b)?[].concat(b):a.isObject(b)?a.isPlainObject(b)?a.copy(b):b:b}}),c}),g("event-wall",["utils","event"],function(a,b){"use strict";function c(a){c.__super__.constructor.apply(this,arguments),this.name=a}return a.inherit(c,b),new c("cloudaui")}),g("id-generator",["utils"],function(a){"use strict";function b(a,b){this.__pre=a,this.__base=b||1}return a.extend(b.prototype,{getId:function(){return this.__pre+":"+this.__base++}}),b}),g("databinding-parser",["utils","consts","event","pubsub","event-wall","id-generator"],function(a,b,c,d,e,f){"use strict";function g(b,c){g.__super__.constructor.apply(this,arguments),this.options=a.extend({getData:function(){throw new Error("getData not implement")},setData:function(){throw new Error("setData not implement")}},c),this.obj=this.options.obj,this.__pubsub=new d(b),this.__nodeMap={};var f=this;e.on("elementReplaced",function(a,b){var c=f.__getNodeId(b);c&&(f.__nodeMap[c]=a)}),this.onDestroy(this.__onDestroy,0)}var h=b.attrNodeId,i=/\{\{([^}]+)\}\}/im,j=/\{\{([^}]+)\}\}/gim,k=new f("nid");return a.inherit(g,c),a.extend(g.prototype,{__onDestroy:function(){this.__nodeMap=null,this.__pubsub.destroy(),this.__pubsub=null},getPubSub:function(){return this.__pubsub},injectHTMLEntity:function(a){this.__parseNode(this.obj,a)},compileData_:function(b){var c,d=this;if((c=b.match(i))&&2==c.length&&c[0].length==b.length){var e=d.options.getData(c[1]);return"undefined"==typeof e||a.isFunction(e)?b:e}var f=b.replace(j,function(b,c){var e=d.options.getData(c);return"undefined"==typeof e||a.isFunction(e)?b:e});return f},__getNodeId:function(a){return a.setAttribute?a.getAttribute(h):a[h]},__setNodeId:function(a,b){a.setAttribute?a.setAttribute(h,b):a[h]=b},__addToNodeMap:function(a){var b=this.__getNodeId(a);return b||(b=k.getId(),this.__setNodeId(a,b),this.__nodeMap[b]=a),b},__getNodeById:function(a){return this.__nodeMap[a]},__getSubFuncForTextNode:function(b,c){var d=this;return function(){var e=d.__getNodeById(b);return e?(e.nodeValue=d.compileData_(c),void 0):(a.log.warn("Node not found: ",b),void 0)}},__getSubFuncForInput:function(b,c){var d=this;return function(){var e=d.__getNodeById(b);if(!e)return a.log.warn("Node not found: ",b),void 0;var f=d.compileData_(c);e.setAttribute("value",f),e.value=f}},__getSubFuncForAttr:function(b,c,d){var e=this;return function(){var f=e.__getNodeById(b);if(!f)return a.log.warn("Node not found: ",b),void 0;var g=e.compileData_(d),h=a.isSimpleValue(g);f.setAttribute(c,h?g:Object.prototype.toString.call(g)),h&&a.isSetter(f,c)===!1||(f[c]=g)}},parseTxtNode:function(a,b){function c(){if(!h){var b=g.__addToNodeMap(a);h=g.__getSubFuncForTextNode(b,e)}return h}for(var d,e=a.nodeValue,f=e,g=this,h=null;;){if(d=f.match(i),!d)break;if(2==d.length){var j=b+"_"+d[1];this.__pubsub.subscribe(j,c()),f=f.replace(d[0],"")}}a.nodeValue=f},parseInput:function(b,c){function d(){if(!l){var a=g.__addToNodeMap(b);l=g.__getSubFuncForInput(a,h)}return l}var e,f,g=this,h=b.getAttribute("value"),j=null,k=null;if(h){for(var l=null;;){if(f=b.getAttribute("value").match(i),!f)break;2==f.length&&(e=c+"_"+f[1],this.__pubsub.subscribe(e,d()),b.setAttribute("value",b.getAttribute("value").replace(f[0],"")),j=f[0],k=f[1])}a.trim(h)==j&&b.addEventListener("change",function(a){g.options.setData(k,(a.target||a.srcElement).value)})}},parseAttrs:function(a,b){var c=a.attributes;c.length&&[].forEach.call(c,function(c){var d,e,f=c.localName,g=c.nodeValue;for(d=g;;){if(e=d.match(i),!e)break;if(2==e.length){var h=this.__addToNodeMap(a),j=this.__getSubFuncForAttr(h,f,g),k=b+"_"+e[1];this.__pubsub.subscribe(k,j),d=d.replace(e[0],"")}}},this)},__parseNode:function(b,c,d){if(d=d||{},3===b.nodeType)this.parseTxtNode(b,c);else{if(1===b.nodeType&&("input"==b.tagName.toLowerCase()&&"undefined"!=typeof b.value?this.parseInput(b,c):this.parseAttrs(b,c)),b.tagName&&a.isCloudaUITag(b.tagName))return;b.childNodes&&[].forEach.call(b.childNodes,function(a){this.__parseNode(a,c)},this)}}}),g}),g("data-gear",["utils","consts","ui-script","databinding-parser","event"],function(a,b,c,d,e){"use strict";function f(b,e,g,h){f.__super__.constructor.apply(this,["datagear"]);var i=this;if(this.obj=e,!(this.obj&&"nodeType"in this.obj))throw new Error("unknown DataGear obj",this.obj);this.def=g,this.uuid=b,this.scriptObj=new c(g.name+"_"+b,{define:g,uuid:b,$:{root:e,content:h}},g.scriptOptions),this.__circularDataChangeStack=[],this.__scriptObjDataContainer={},this.scriptObj.$=this.scriptObj.$||{};var j={};[].forEach.call(this.obj.querySelectorAll("[id]"),function(a){j[a.id]=a}),a.extend(this.scriptObj.$,{el:j}),a.extend(this.scriptObj,{sync:function(){i.__sync()}}),this.onDestroy(this.__onDestroy,0),this.__tplParser=new d("datagear",{obj:this.obj,getData:function(b){return a.pathValue(i.__scriptObjDataContainer,b)},setData:function(b,c){a.pathValue(i.__scriptObjDataContainer,b,c,!0),i.__sync()}}),this.__pubsub=this.__tplParser.getPubSub(),this.__tplParser.injectHTMLEntity(b),this.__injectScript(),this.__engagePublicAttribute()}var g="Changed";return a.inherit(f,e),a.extend(f.prototype,{runScript:function(){var a=this;a.emit("beforeGearCreated",a),a.scriptObj.created&&a.scriptObj.created(a.obj),a.emit("gearCreated",a),a.__scriptCreated=!0,a.def.onReady(function(){a.emit("defineReady",a),a.emit("beforeGearReady",a),a.scriptObj.ready&&a.scriptObj.ready(a.obj),a.emit("gearReady",a),a.__scriptReady=!0})},__sync:function(){var a=this.__scriptObjDataContainer;for(var b in a)this.__executeSetter(b,a[b])},__onDestroy:function(){a.isFunction(this.scriptObj.destroy)&&this.scriptObj.destroy(this.obj),this.obj=null,this.scriptObj=null,this.__tplParser.destroy()},__engagePublicAttribute:function(){var b=this,c=this.def.attributes.attributes||"";return""===(c=a.trim(c))?!1:(c=c.split(/\s+/),0===c.length?!1:(c.forEach(function(c){!function(b,c,d){a.isDefined(d[b])||a.log.warn("Attribute "+b+" is not defined"),c.__defineGetter__(b,function(){return a.isFunction(d[b])?function(){return d[b].apply(d,arguments)}:d[b]}),c.__defineSetter__(b,function(a){d[b]=a})}(c,b.obj,b.scriptObj)}),void 0))},__publishSubValue:function(b,c){var d=this.uuid+"_"+b;this.__pubsub.keys().forEach(function(e){if(e.length!=d.length&&0===e.indexOf(d)){var f=e.substr(e.indexOf(b));if(!a.isDefined(this.__scriptObjDataContainer[f])){var g={};g[b]=c,this.__pubsub.publish(e,a.pathValue(g,f))}}},this)},__publish:function(a,b){var c=this.uuid+"_"+a;this.__pubsub.publish(c,b),this.__publishSubValue(a,b)},__executeSetter:function(b,c,d){var e=this.uuid+"_"+b,f=this.__pubsub.getPubedValue(e);if(!a.isEqual(c,f)){if(this.circularDataChangeDetect_(b)===!0)return a.log.warn("circular attribute set detected: ",b),this.__circularDataChangeStack.length=0,void 0;this.__circularDataChangeStack.push(b),this.__scriptObjDataContainer[b]=c,this.__publish(b,c),d||(this.__scriptCreated&&this.scriptObj[b+g]&&this.scriptObj[b+g].call(this.scriptObj,c,f),a.trigger(this.obj,b+g,c)),this.__circularDataChangeStack.pop()}},castType_:function(b,c){if("undefined"==typeof b)return c;var d=c;return a.isNumber(b)?(d=Number(c),!0===isNaN(d)&&(d=c)):a.isString(b)&&(d=String(c)),d},__injectScript:function(){function b(a){c.__defineGetter__(a,function(){return d.__scriptObjDataContainer[a]}),c.__defineSetter__(a,function(b){d.__executeSetter(a,b,!1)})}var c=this.scriptObj,d=this,e=[];for(var f in this.def.scriptOptions)c.hasOwnProperty(f)&&"$"!=f&&(a.isFunction(c[f])||(d.__scriptObjDataContainer[f]=c[f],b(f),e.push(f)));e.forEach(function(b){var d=this.obj.getAttribute(b);null===d?d=c[b]:b in this.obj&&!a.isSimpleValue(this.obj[b])&&(d=this.obj[b]),this.__executeSetter(b,d,!0)},this)},circularDataChangeDetect_:function(b){return this.__circularDataChangeStack.indexOf(b)>-1?(a.log.debug("circular attribute",b,[].concat(this.__circularDataChangeStack)),this.__circularDataChangeStack.length=0,!0):!1}}),f}),g("async-helper",["utils"],function(a){"use strict";var b={parallel:function(a,b,c){function d(){b&&b.call(c.thisArg,f,g)}var e=a.length,f=null,g=[];return c=this.__extendOpts(c),e?(a.forEach(function(a,b){this.__runTask(a,function(a,c){e--,f=f||a,g[b]=c,e||d()},c)},this),void 0):(d(),void 0)},sequence:function(a,b,c){function d(){b&&b.call(c.thisArg,f,g)}var e=a.length,f=null,g=[],h=0,i=this;return c=this.__extendOpts(c),e?(this.__runTask(a[h],function j(b,k){e--,f=f||b,g[h]=k,e?i.__runTask(a[++h],j,c):d()},c),void 0):(d(),void 0)},__extendOpts:function(b){return a.extend({},{timeout:15e3,thisArg:d},b)},__runTask:function(b,c,d){var e=setTimeout(function(){c.apply(d.thisArg,[504,"Time out"]),e=null},d.timeout);b(function(){return e?(clearTimeout(e),c.apply(d.thisArg,arguments),void 0):(a.log.warn("Task alreay timeout"),void 0)})}};return b}),g("global-resource-manager",["utils","live-item-manager","async-helper","live-item"],function(a,e,f,g){"use strict";function h(){h.__super__.constructor.apply(this,arguments)}var i={},j={},k={};return a.inherit(h,e),a.extend(h.prototype,{__filterResouce:function(a){switch(a.type){case"link":if(j[a.id])return j[a.id];break;case"script":if(k[a.id])return k[a.id]}return a},loadGlobalStyle:function(a){j[a.id]={type:"style",id:a.id,html:'<style global="'+a.id.replace(/"/g,"&quot;")+'">\n'+a.body+"\n</style>"}},loadGlobalScript:function(c){var d=c.body;d&&(a.isFunction(d)?d.call(b):a.isString(d)&&a.runInGlobal(d,{window:b})),k[c.id]={type:"script",id:c.id,html:'<script global="'+c.id.replace(/"/g,"&quot;")+'" type="text/clouaui-loaded-script"></script>'}},importResources:function(b,c){var d=function(b,d){c&&a.nextTick(function(){c(b,d)})};if(!a.isArray(b)||!b.length)return d&&d(null,null),void 0;var e=this,g=b.map(function(a){return function(b){e.importSingleResource(a,b)}},this);f.parallel(g,function(a,b){d&&d(a,b)})},importSingleResource:function(b,e){function f(c){return u?(a.log.warn("Resouce callbacked alreay: "+b.id),void 0):(clearTimeout(v),u=!0,s.__decreaseUnReadyCount(),h.emitReady(c,b.id),void 0)}b=this.__filterResouce(b);var h=i[b.id];if(h||(h=new g(b.id)),h.onReady(function(){e&&e.apply(d,arguments)}),!i[b.id]){var j=c.getElementsByTagName("head")[0];i[b.id]=h;var k=c.createElement("div");k.innerHTML=b.html;var l=k.firstChild;if(Array.prototype.slice.call(j.getElementsByTagName(l.tagName)).some(function(a){return a.getAttribute("global")==b.id}))return a.log.debug("Found global resource: ",b.id),h.emitReady(null,b.id),void 0;for(var m=c.createElement(l.tagName),n=0,o=l.attributes.length;o>n;n++){var p=l.attributes[n].name,q=l.attributes[n].value;m.setAttribute(p,q)
}if(b.attributes)for(var r in b.attributes)m.setAttribute(r,b.attributes[r]);m.innerHTML=l.innerHTML;var s=this;s.__increaseUnReadyCount();var t=!1,u=!1,v=setTimeout(function(){a.log.error("Script load timeout: ",m.src),f(504,"Timeout")},15e3);"SCRIPT"==m.tagName&&m.src&&(t=!0,m.async=!1,m.onreadystatechange=function(){"complete"==this.readyState&&f(null)},m.onload=function(){f(null)},m.onerror=function(){f(404)}),a.log.debug("Add global resource: ",b.id),j.appendChild(m),t||f(null)}}}),new h("clouda")}),g("ui-render",["utils","consts","ui-registry","event","data-gear","event-wall","global-resource-manager","id-generator"],function(a,b,d,e,f,g,h,i){function j(a){j.__super__.constructor.apply(this,arguments),this.name=a}var k="_cloudaui_",l=new i("uuid"),m=new i("sel");return a.inherit(j,e),a.extend(j.prototype,{upgradeElement:function(b,e){var i=b.tagName.toLowerCase(),j=d.getDefine(i);if(!j)return!1;var m=a.extend({},e),n=c.createElement("div");this.__copyProps(n,b),n.className=k+i+(""===b.className?"":" "+b.className);var o="<style scoped>"+this.__scopedCSSPolyfill(j.style,k+i)+"</style>";o+=j.template,n.innerHTML=o;for(var p=b.innerHTML,q=n.querySelectorAll("content"),r=0,s=q.length;s>r;r++)q[r].outerHTML=p;g.emit("beforeElementReplaced",n,b),b.parentNode.replaceChild(n,b),g.emit("elementReplaced",n,b);var t=new f(m.uuid||i+":"+l.getId(),n,j,p);return this.__bindEvents(t),h.importResources(j.globalResources,function(){t.runScript()}),t},__bindEvents:function(d){var e=d.obj.innerHTML;if(!(e.indexOf("on-")<0)){if("object"!=typeof touch||!touch.on||!touch.trigger)return a.log.warn("touch lib is not loaded, see: http://code.baidu.com/"),void 0;var f=function(a){var b="blur,focus,load,scroll";return b.split(",").indexOf(a.toLowerCase())>=0?!1:!0},g=function(e,g,h){var i=d.scriptObj[h];if(!a.isFunction(i))return a.log.warn("function not exists: ",h),void 0;var j=function(){i.apply(d.scriptObj,arguments)};if(f(g)){var k=b.attrSelector,l=e.getAttribute(k);l||(l=m.getId(),e.setAttribute(k,l));var n=e.tagName+"["+k+'="'+l+'"]';touch.on(c.body,g,n,j),d.onDestroy(function(){touch.off(c.body,g,n,j)})}else touch.on(e,g,j),d.onDestroy(function(){touch.off(e,g,j)})};[].forEach.call(d.obj.getElementsByTagName("*"),function(a){[].forEach.call(a.attributes,function(b){0===b.name.indexOf("on-")&&g(a,b.name.substr(3),b.value)})})}},__copyProps:function(b,c){var d=c.attributes||[];[].forEach.call(d,function(d){b.setAttribute(d.localName,d.nodeValue),d.localName in c&&!a.isSimpleValue(c[d.localName])&&(b[d.localName]=c[d.localName])})},__scopedCSSPolyfill:function(b,c){function d(b){return b.split(",").map(function(b){var d=a.trim(b);return d?c+" "+d:b}).join(",")}c="."+c;var e={},f="#@~"+a.random(5)+":",g=1;b=b.replace(/{([^}]*)}/gm,function(a){var b=f+g++;return e[b]=a,"\n"+b+"\n"});var h="",i=[];return b.split("\n").forEach(function(a){return 0===a.indexOf(f)?(i.push(d(h)+"\n"+e[a]),h="",void 0):(h+="\n"+a,void 0)}),i.join("\n")}}),new j("cloudaui")}),g("mutation-monitor",["utils","event"],function(a,b){"use strict";function d(a){d.__super__.constructor.apply(this,arguments),this.name=a}return a.inherit(d,b),a.extend(d.prototype,{observe:function(){function b(a){[].forEach.call(a,e.__handleAddedNode,e)}function d(a){[].forEach.call(a,e.__handleRemovedNode,e)}if("undefined"==typeof MutationObserver)return a.log.info("MutationObserver not supported!!"),this.__observeSpecial(),void 0;var e=this;this.disconnect();var f=new MutationObserver(function(a){a.forEach(function(a){b(a.addedNodes),d(a.removedNodes)})});return f.observe(c.body,{childList:!0,subtree:!0}),this.__uiTagObserver=f,f},disconnect:function(){this.__uiTagObserver&&(this.__uiTagObserver.disconnect(),this.__uiTagObserver=null)},__observeSpecial:function(){var a=this;c.body.addEventListener("block_after_render",function(b){a.__handleAddedNode(b.target)}),c.body.addEventListener("block_before_render",function(b){a.__handleRemovedNode(b.target)})},__handleAddedNode:function(a){a.tagName&&this.emit("node_added",a)},__handleRemovedNode:function(a){a.tagName&&this.emit("node_removed",a)}}),new d("cloudaui")}),g("runtime",["utils","consts","ui-registry","live-item","ui-render","mutation-monitor"],function(a,b,d,e,f,g){"use strict";function h(a){h.__super__.constructor.apply(this,arguments),this.name=a,this.__unUpgradedItems={},this.__gearHash={}}var i=b.attrUUID,j=b.attrUpgradedFlag;return a.inherit(h,e),a.extend(h.prototype,{init:function(){this.__listenEnv(),this.__monitorInitialUIElements(),this.scan(),g.observe(),this.__scheduleReady(1e4,function(){a.log.error("clouda ui ready timeout!!")})},__listenEnv:function(){var b=this;d.onUnReadyCountDownToZero(function(){b.__scheduleReady(70,function(){a.log.debug("Nothing left to be imported now!")})}),d.on("fetchElementDone",function(){b.scan()}),g.on("node_added",function(a){b.scan(a)}),g.on("node_removed",function(a){var c=[].slice.call(a.querySelectorAll("["+i+"]"));a.getAttribute&&a.getAttribute(i)&&c.unshift(a),[].forEach.call(c,function(a){var c=a.getAttribute(i),d=b.__gearHash[c];d&&d.destroy()})})},onUpgrade:function(b,c){if(!(b&&"nodeType"in b))throw new Error("HTMLElement is supposed");var d=this.__setElementUUID(b),f=this.__unUpgradedItems[d];f||(f=new e(d),this.__unUpgradedItems[d]=f),f.onReady(c),this.__doesElementUpgraded(b)&&(a.log.debug("Already been upgraded",b),f.emitReady(b))},addReadyListener:function(a){this.onReady(a)},systemReady:function(){this.__ready||(this.__ready=!0,this.__clearScheduleReady(),c.body.style.opacity=1,this.emitReady())},__setElementUUID:function(b,c){var d=b.getAttribute(i);return(!d||c)&&(d=c||a.random(10),b.setAttribute(i,d)),d},__scheduleReady:function(a,b){this.__clearScheduleReady();var c=this;this.__systemReadyTimeId=setTimeout(function(){c.__systemReadyTimeId=null,c.systemReady(),b&&b()},a)},__clearScheduleReady:function(){this.__systemReadyTimeId&&(clearTimeout(this.__systemReadyTimeId),this.__systemReadyTimeId=null)},__monitorInitialUIElements:function(){function b(){e--,0===e&&(a.log.debug("All initial ui elements upgraded"),f.systemReady())}var d=Array.prototype.slice.call(c.getElementsByTagName("*"));d=d.filter(function(b){return a.isCloudaUITag(b.tagName)},this);var e=d.length,f=this;return e?(d.forEach(function(a){this.onUpgrade(a,b)},this),void 0):(a.nextTick(function(){f.systemReady()}),void 0)},scan:function(b,e){if(e)a.isArray(e)||(e=[e]);else{e=[];for(var f in d.getDefines())e.push(f)}e.length&&(b=b||c,(!c.contains||c.contains(b))&&(b.tagName&&e.indexOf(b.tagName.toLowerCase())>=0&&this.__upgrade(b),e.forEach(function(a){var c=Array.prototype.slice.call(b.getElementsByTagName(a));c.forEach(function(a){this.__upgrade(a)},this)},this)))},__doesElementUpgraded:function(a){return!!a.getAttribute(j)},__upgrade:function(b){if(b.parentNode){if(this.__doesElementUpgraded(b))return a.log.warn("Element already upgraded: ",b),this.__gearHash[b.getAttribute(i)];var c=f.upgradeElement(b);if(!c)return!1;var d=this;return c.on("defineReady",function(){d.scan(c.obj)}),this.__setElementUUID(c.obj,c.uuid),this.__gearHash[c.uuid]=c,c.onDestroy(function(){delete d.__gearHash[c.uuid]}),this.__elementUpgraded(b,c.obj),c}},__elementUpgraded:function(a,b){b.setAttribute(j,1);var c=a.getAttribute(i);c&&this.__unUpgradedItems[c]&&this.__unUpgradedItems[c].emitReady(b)}}),new h("cloudaui")}),g("main",["utils","ui-registry","loader","ui-importer","runtime","global-resource-manager"],function(a,b,c,d,e,f){"use strict";function g(a,b){b.forEach(function(b){i[b]=function(){return a[b].apply(a,arguments)}})}var h=b.getDefines(),i=function(){b.defineUI.apply(b,arguments)},j=function(){i.debug=!0,i.def_=h,i.runtime=e,i.utils=a,a.setDebugMode(!0)};return a.domReady(function(){e.init()}),a.extend(i,{debug:!1,enterDebugMode:j,"import":function(){b.fetchElementDef.apply(b,arguments)},scan:function(){e.scan()},ready:function(){e.addReadyListener.apply(e,arguments)},init:function(a,b){e.onUpgrade(a,b),e.scan(a)},batchImport:function(){},addLoaderCache:function(){c.addCache.apply(c,arguments)},addImporterCache:function(){d.addCache.apply(d,arguments),b.fetchElementDef(d.getHistoryUrls())}}),g(f,["loadGlobalStyle","loadGlobalScript"]),i}),a.ui=f("main")}(clouda,window,document);